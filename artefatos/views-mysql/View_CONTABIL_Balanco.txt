CREATE VIEW VIEW_BALANCO_PATRIMONIAL
AS
select 
	CAST( CONCAT(cccab.ID,ccdet.ID) as UNSIGNED) as id, 
	DATE_FORMAT(cccab.data_lancamento,'%Y') as ano,
	cc.classificacao as classificacao,
	cc.descricao as descricao, 
	sum(ccdet.valor) as valor
from
	contabil_conta cc 
	inner join contabil_lancamento_detalhe ccdet on (ccdet.id_contabil_conta = cc.id)
	inner join contabil_lancamento_cabecalho cccab on (ccdet.id_contabil_lancamento_cab = cccab.id)
group by 
	ANO, classificacao, descricao