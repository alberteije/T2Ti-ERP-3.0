create
view view_pessoa_fornecedor
as

select 
	f.id,
	p.nome, p.tipo, p.email, p.site, 
	pf.cpf as "cpf_cnpj", 
	pf.rg as "rg_ie",
	f.desde,
	f.data_cadastro,
	f.observacao,
	e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
	p.id as "id_pessoa"
from
	pessoa p 
	inner join pessoa_fisica pf on (pf.id_pessoa = p.id)
	inner join fornecedor f on (f.id_pessoa = p.id)
	left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
	p.eh_fornecedor = "S"

union

select 
	f.id,
	p.nome, p.tipo, p.email, p.site, 
	pj.cnpj as "cpf_cnpj", 
	pj.inscricao_estadual as "rg_ie",
	f.desde,
	f.data_cadastro,
	f.observacao,
	e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
	p.id as "id_pessoa"
from
	pessoa p 
	inner join pessoa_juridica pj on (pj.id_pessoa = p.id)
	inner join fornecedor f on (f.id_pessoa = p.id)
	left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
	p.eh_fornecedor = "S"
