create view view_fin_fluxo_caixa (
    id,
    id_banco_conta_caixa,
    nome_conta_caixa,
    nome_pessoa,
    data_lancamento,
    data_vencimento,
    valor,
    codigo_situacao,
    descricao_situacao,
    operacao
) as

select
    cast(concat(lp.id, pp.id) as unsigned) as id,
    cc.id as id_banco_conta_caixa,
    cc.nome as nome_conta_caixa,
    p.nome as nome_pessoa,
    lp.data_lancamento,
    pp.data_vencimento,
    pp.valor,
    sp.situacao as codigo_situacao,
    sp.descricao as descricao_situacao,
    'S' as operacao

from
    fin_parcela_pagar pp
    inner join fin_lancamento_pagar lp on pp.id_fin_lancamento_pagar = lp.id
    inner join banco_conta_caixa cc on lp.id_banco_conta_caixa = cc.id
    inner join fornecedor f on lp.id_fornecedor = f.id
    inner join pessoa p on f.id_pessoa = p.id
    inner join fin_status_parcela sp on pp.id_fin_status_parcela = sp.id

where
    sp.situacao = '01' or sp.situacao = '04'

union

select
    cast(concat(lr.id, pr.id) as unsigned) as id,
    cc.id as id_banco_conta_caixa,
    cc.nome as nome_conta_caixa,
    p.nome as nome_pessoa,
    lr.data_lancamento,
    pr.data_vencimento,
    pr.valor,
    sp.situacao as codigo_situacao,
    sp.descricao as descricao_situacao,
    'E' as operacao

from
    fin_parcela_receber pr
    inner join fin_lancamento_receber lr on pr.id_fin_lancamento_receber = lr.id
    inner join banco_conta_caixa cc on lr.id_banco_conta_caixa = cc.id
    inner join cliente c on lr.id_cliente = c.id
    inner join pessoa p on c.id_pessoa = p.id
    inner join fin_status_parcela sp on pr.id_fin_status_parcela = sp.id

where
    sp.situacao = '01' or sp.situacao = '04'

order by 1;
