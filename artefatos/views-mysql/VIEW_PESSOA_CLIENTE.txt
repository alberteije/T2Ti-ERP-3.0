create view view_pessoa_cliente as

select 
    c.id,
    p.nome, p.tipo, p.email, p.site, 
    pf.cpf as cpf_cnpj, 
    pf.rg as rg_ie,
    c.desde,
    c.taxa_desconto,
    c.limite_credito,
    c.data_cadastro,
    c.observacao,
    e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
    p.id as id_pessoa
from
    pessoa p 
    inner join pessoa_fisica pf on (pf.id_pessoa = p.id)
    inner join cliente c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
    p.eh_cliente = 'S'

union

select 
    c.id,
    p.nome, p.tipo, p.email, p.site, 
    pj.cnpj as cpf_cnpj, 
    pj.inscricao_estadual as rg_ie,
    c.desde,
    c.taxa_desconto,
    c.limite_credito,
    c.data_cadastro,
    c.observacao,
    e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
    p.id as id_pessoa
from
    pessoa p 
    inner join pessoa_juridica pj on (pj.id_pessoa = p.id)
    inner join cliente c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
    p.eh_cliente = 'S';
