CREATE
VIEW VIEW_PESSOA_VENDEDOR
AS

SELECT 
	C.ID,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, 
	PF.CPF AS "CPF_CNPJ", 
	PF.RG AS "RG_IE",
	C.MATRICULA,
	C.DATA_CADASTRO,
	C.DATA_ADMISSAO,
	C.DATA_DEMISSAO,
	C.CTPS_NUMERO,
	C.CTPS_SERIE,
	C.CTPS_DATA_EXPEDICAO,
	C.CTPS_UF,
	C.OBSERVACAO,
	E.LOGRADOURO, E.NUMERO, E.COMPLEMENTO, E.BAIRRO, E.CIDADE, E.CEP, E.MUNICIPIO_IBGE, E.UF,
	P.ID AS "ID_PESSOA",
	C.ID_CARGO,
	C.ID_SETOR,
	V.COMISSAO,
	V.META_VENDA
FROM
	PESSOA P 
	INNER JOIN PESSOA_FISICA PF ON (PF.ID_PESSOA = P.ID)
	INNER JOIN COLABORADOR C ON (C.ID_PESSOA = P.ID)
	INNER JOIN PESSOA_ENDERECO E ON (E.ID_PESSOA = P.ID)
	INNER JOIN VENDEDOR V ON (V.ID_COLABORADOR = C.ID)
WHERE 
	P.EH_COLABORADOR = "S" AND E.PRINCIPAL = "S"

UNION

SELECT 
	C.ID,
	P.NOME, P.TIPO, P.EMAIL, P.SITE, 
	PJ.CNPJ AS "CPF_CNPJ", 
	PJ.INSCRICAO_ESTADUAL AS "RG_IE",
	C.MATRICULA,
	C.DATA_CADASTRO,
	C.DATA_ADMISSAO,
	C.DATA_DEMISSAO,
	C.CTPS_NUMERO,
	C.CTPS_SERIE,
	C.CTPS_DATA_EXPEDICAO,
	C.CTPS_UF,
	C.OBSERVACAO,
	E.LOGRADOURO, E.NUMERO, E.COMPLEMENTO, E.BAIRRO, E.CIDADE, E.CEP, E.MUNICIPIO_IBGE, E.UF,
	P.ID AS "ID_PESSOA",
	C.ID_CARGO,
	C.ID_SETOR,
	V.COMISSAO,
	V.META_VENDA
FROM
	PESSOA P 
	INNER JOIN PESSOA_JURIDICA PJ ON (PJ.ID_PESSOA = P.ID)
	INNER JOIN COLABORADOR C ON (C.ID_PESSOA = P.ID)
	INNER JOIN PESSOA_ENDERECO E ON (E.ID_PESSOA = P.ID)
	INNER JOIN VENDEDOR V ON (V.ID_COLABORADOR = C.ID)
WHERE 
	P.EH_COLABORADOR = "S" AND E.PRINCIPAL = "S"