create view view_pessoa_vendedor as

select 
    c.id,
    p.nome, p.tipo, p.email, p.site, 
    pf.cpf as cpf_cnpj, 
    pf.rg as rg_ie,
    c.matricula,
    c.data_cadastro,
    c.data_admissao,
    c.data_demissao,
    c.ctps_numero,
    c.ctps_serie,
    c.ctps_data_expedicao,
    c.ctps_uf,
    c.observacao,
    e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
    p.id as id_pessoa,
    c.id_cargo,
    c.id_setor,
    v.comissao,
    v.meta_venda
from
    pessoa p 
    inner join pessoa_fisica pf on (pf.id_pessoa = p.id)
    inner join colaborador c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
    inner join vendedor v on (v.id_colaborador = c.id)
where 
    p.eh_colaborador = 'S'

union

select 
    c.id,
    p.nome, p.tipo, p.email, p.site, 
    pj.cnpj as cpf_cnpj, 
    pj.inscricao_estadual as rg_ie,
    c.matricula,
    c.data_cadastro,
    c.data_admissao,
    c.data_demissao,
    c.ctps_numero,
    c.ctps_serie,
    c.ctps_data_expedicao,
    c.ctps_uf,
    c.observacao,
    e.logradouro, e.numero, e.complemento, e.bairro, e.cidade, e.cep, e.municipio_ibge, e.uf,
    p.id as id_pessoa,
    c.id_cargo,
    c.id_setor,
    v.comissao,
    v.meta_venda
from
    pessoa p 
    inner join pessoa_juridica pj on (pj.id_pessoa = p.id)
    inner join colaborador c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
    inner join vendedor v on (v.id_colaborador = c.id)
where 
    p.eh_colaborador = 'S';
