create view view_pessoa_transportadora as

select 
    t.id,
    p.nome, p.tipo, p.email, p.site, 
    pf.cpf as cpf_cnpj, 
    pf.rg as rg_ie,
    t.data_cadastro,
    t.observacao,
    p.id as id_pessoa
from
    pessoa p 
    inner join pessoa_fisica pf on (pf.id_pessoa = p.id)
    inner join transportadora t on (t.id_pessoa = p.id)
where 
    p.eh_transportadora = 'S'

union

select 
    t.id,
    p.nome, p.tipo, p.email, p.site, 
    pj.cnpj as cpf_cnpj, 
    pj.inscricao_estadual as rg_ie,
    t.data_cadastro,
    t.observacao,
    p.id as id_pessoa
from
    pessoa p 
    inner join pessoa_juridica pj on (pj.id_pessoa = p.id)
    inner join transportadora t on (t.id_pessoa = p.id)
where 
    p.eh_transportadora = 'S';
