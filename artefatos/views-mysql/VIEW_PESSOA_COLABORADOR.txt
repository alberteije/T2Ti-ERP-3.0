create view view_pessoa_colaborador as

select 
    c.id as id,
    p.nome as nome, 
    p.tipo as tipo, 
    p.email as email, 
    p.site as site, 
    pf.cpf as cpf_cnpj, 
    pf.rg as rg_ie,
    c.matricula as matricula,
    c.data_cadastro as data_cadastro,
    c.data_admissao as data_admissao,
    c.data_demissao as data_demissao,
    c.ctps_numero as ctps_numero,
    c.ctps_serie as ctps_serie,
    c.ctps_data_expedicao as ctps_data_expedicao,
    c.ctps_uf as ctps_uf,
    c.observacao as observacao,
    e.logradouro as logradouro, 
    e.numero as numero, 
    e.complemento as complemento, 
    e.bairro as bairro, 
    e.cidade as cidade, 
    e.cep as cep, 
    e.municipio_ibge as municipio_ibge, 
    e.uf as uf,
    p.id as id_pessoa,
    c.id_cargo as id_cargo,
    c.id_setor as id_setor
from
    pessoa p 
    inner join pessoa_fisica pf on (pf.id_pessoa = p.id)
    inner join colaborador c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
    p.eh_colaborador = 'S'

union

select 
    c.id as id,
    p.nome as nome, 
    p.tipo as tipo, 
    p.email as email, 
    p.site as site, 
    pj.cnpj as cpf_cnpj, 
    pj.inscricao_estadual as rg_ie,
    c.matricula as matricula,
    c.data_cadastro as data_cadastro,
    c.data_admissao as data_admissao,
    c.data_demissao as data_demissao,
    c.ctps_numero as ctps_numero,
    c.ctps_serie as ctps_serie,
    c.ctps_data_expedicao as ctps_data_expedicao,
    c.ctps_uf as ctps_uf,
    c.observacao as observacao,
    e.logradouro as logradouro, 
    e.numero as numero, 
    e.complemento as complemento, 
    e.bairro as bairro, 
    e.cidade as cidade, 
    e.cep as cep, 
    e.municipio_ibge as municipio_ibge, 
    e.uf as uf,
    p.id as id_pessoa,
    c.id_cargo as id_cargo,
    c.id_setor as id_setor
from
    pessoa p 
    inner join pessoa_juridica pj on (pj.id_pessoa = p.id)
    inner join colaborador c on (c.id_pessoa = p.id)
    left join pessoa_endereco e on (e.id_pessoa = p.id)
where 
    p.eh_colaborador = 'S';
